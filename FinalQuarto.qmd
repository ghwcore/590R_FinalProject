---
title: "Final Quarto Report"
execute:
  warning: false
format:
  html:
    theme: zephyr
echo: false
---
This dataset was used to compare non-esterified fatty acids (NEFA) in 
pregnan twomen with dystocia. NEFA levels can be used to measure the rate of
lipolysis which is the breakdown of adipose tissue. The levels can help 
determine metabolic stress occurring during labor.

```{r}
#| echo: false
#Add data
#here::here("pregnancy_data.csv")
dat <- read.csv(here::here("pregnancy_data.csv"))

#add library
library(tidyverse)
library(gtsummary)
library(ggplot2)


```



```{r}
#| label: tbl-ds
#| tbl-cap: "Descriptive statistics"
#Create descriptive table using {gtsummary}
tbl_summary(dat,
						by =DystociaCase,
						include = c(age, active_labor_duration_min, BMI_late, SES_Index, gravidity,
  											parity, NEFA__Acetate, NEFA__Butyrate, NEFA__Iso.Valerate,
												NEFA__Iso.Caprate, NEFA__Formate, NEFA__Propionate,
												NEFA__Stearic, NEFA__Hexanoic, NEFA__Arachidonic),
						#Modify to show min and max
						statistic = list(
												all_continuous() ~ "{mean} ({min}, {max})"

						)
						) |>
						#add test
						add_p(test = list(
							all_continuous() ~ "t.test",
							all_categorical() ~ "chisq.test"
							))
```

@tbl-ds: Descriptive Statistic Table

```{r}
logistic_model <- glm(DystociaCase ~ age + gravidity + parity,
											data = dat, family = binomial()
)

#summary(logistic_model)
```



```{r}
#| label: tbl-02
#| tbl-cap: "Logistic Regression Table"
#logistic table
tbl_regression(
	logistic_model,
	exponentiate = TRUE

)
```
@tbl-02: Logistic Regression Table


```{r}
#| label: tbl-03
#| tbl-cap: "Histogram of SES Index"
hist(dat$SES_Index)


```


```{r}
ds <- list(n = nrow(dat), 
					 mean_age = mean(dat$age, na.rm = TRUE)
					 )
```

From the dataset, the total of participants were `r ds$n` and mean age was `r ds$mean_age`.


```{r}
tabledat <- tbl_summary(dat,
						by =DystociaCase,
						include = c(age, active_labor_duration_min, BMI_late, SES_Index, gravidity,
  											parity, NEFA__Acetate, NEFA__Butyrate, NEFA__Iso.Valerate,
												NEFA__Iso.Caprate, NEFA__Formate, NEFA__Propionate,
												NEFA__Stearic, NEFA__Hexanoic, NEFA__Arachidonic),
						#Modify to show min and max
						statistic = list(
												all_continuous() ~ "{mean} ({min}, {max})"

						)
						) |>
						#add test
						add_p(test = list(
							all_continuous() ~ "t.test",
							all_categorical() ~ "chisq.test"
							))

```



```{r}
ses1 <- inline_text(tabledat, variable = "SES_Index", column = "stat_2")
ses0 <- inline_text(tabledat, variable = "SES_Index", column = "stat_1")


```

The data shows that the mean SES Index of participants with no case of dsytocia was `r ses0` and 
the mean SES Index of participants with dsytocia was `r ses1`.






```{r}
 #Create a function
run_lin_reg <- function(dat){
	#linear model
	linear_model <- lm(active_labor_duration_min ~ age,
										 data = dat
	)

	tbl_regression(
		linear_model,
		# include the intercept
		intercept = TRUE,
	)


	
} #end function

#run function
run_lin_reg(dat)

linear_model <- lm(active_labor_duration_min ~ age,
										 data = dat
	)

lintbl <-	tbl_regression(
		linear_model,
		# include the intercept
		intercept = TRUE,
	)


age <- inline_text(lintbl, variable = "age")

```

Using a linear regression model, the relationship between age and active
labor duration was analyzed and the results are `r age`.






